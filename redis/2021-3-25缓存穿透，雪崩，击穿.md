# redis 缓存穿透

* 定义:请求中需要的redis的key数据，既没有在缓存中，也没有在数据库中

造成这种问题有两种情况

  1.业务问题，没有预料到所有情况

  2.黑客攻击，黑客构建恶意请求，造成服务器和数据库压力


## 解决方案
  1.**业务返回空值**，根据实际业务来调整，如果有不符合业务的请求，统一返回一个null值，后续请求就不会访问数据库

  2.**请求开始时就判断参数是否非法**，如果非法，接口直接返回

  3.**布隆过滤器**来判断请求参数是否存在，相当于2方案的补充


# redis 缓存击穿

* 定义:redis上的某一个key（通常是热点key），因为失效以后，造成大量请求落在了数据库上，瞬时对服务器以及数据库造成很大压力，引起服务问题

## 解决方案：
  1.**缓存的key设置永久的过期时间**，缺点是可能会造成redis内存不够用，长时间不用会被redis缓存淘汰策略淘汰掉，一般不推荐

  2.**由单一业务更新缓存**，可以新建立一个业务线，所有请求在获取不到缓存的时候，都由这个业务来更新，比如，业务A获取不到key值，则发送请求到新业务线，新业务线设置同步锁来更新redis，或者给消息队列发送消息来更新


# redis 缓存雪崩

* 定义:redis上的key，因为过期时间或者redis宕机等原因，造成缓存大面积失效，相当于大面积缓存击穿

## 解决方案
  1.**缓存永久有效**

  2.**由单一业务更新缓存**

  3.**缓存过期时间增加随机值**，避免同一时间全部失效，然后采用击穿的解决办法

  4.**设置双key**，例如备用key设置为key_old等来缓解压力，然后由单一业务更新缓存


总结：

  缓存击穿和雪崩，实际问题是同一类，解决方案部分是重叠的，根据业务来选择多个方案同时来解决
  
  缓存穿透一般是意外情况，需要单独考虑
  
  
  
